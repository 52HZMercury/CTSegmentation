# Training parameters configuration

# Data paths
data:
  out_dir: "/workdir2/cn24/program/CT_SU/logs"
  exp_name: "exp_2"
  split_json: "metadata/Abdominal_Infrarenal.json"
#  split_json: "metadata/Abdominal_Suprarenal.json"
#  split_json: "metadata/Ascending_Arch.json"
#  split_json: "metadata/Descending_Thoracic.json"
  datasets_key: "training"
  validation_key: "validation"

# Model parameters
model:
  architecture: "BasicUNet"
  spatial_dims: 3
  in_channels: 2 # 拼接了all_lab输入, 所以输入通道数是2
  out_channels: 2
  dropout: 0.0

# Device parameters
device:
  cuda_device: "cuda:0"  # 可以设置为 "cuda:0", "cuda:1" 等来选择特定GPU，或 "cpu" 使用CPU

# Training hyperparameters
training:
  max_epochs: 100
#  max_iterations: 160
#  eval_num: 16
  batch_size: 4
  num_class: 2
  learning_rate: 0.0003
  weight_decay: 0.00001
  cache_num: 170
  cache_rate: 1.0
  num_workers: 2
  pin_memory: False

# Validation parameters
validation:
  batch_size: 4
  cache_num: 40
  cache_rate: 1.0
  num_workers: 0
  pin_memory: False

# Transform parameters
transforms:
  spacing:
    pixdim: [1.62, 1.62, 3.2]
    mode: "bilinear"
  scale_intensity:
    a_min: -79
    a_max: 304
    b_min: 0.0
    b_max: 1.0
    clip: True
  crop_foreground:
    margin: 20
  resize:
    spatial_size: [160, 96, 64]
    mode: "constant"
  rand_crop:
    spatial_size: [64, 64, 64]
    pos: 1
    neg: 0
    num_samples: 4
  rand_shift_intensity:
    offsets: 0.40
    prob: 0.50

# Scheduler parameters
scheduler:
  factor: 0.35
  min_lr: 1e-6
  patience: 5